<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		
		<title>Mariage</title>
		
		<link rel="stylesheet" href="ressources/jquery-ui-1.11.4.custom/jquery-ui.min.css" />
		<link rel="stylesheet" href="ressources/bootstrap-3.3.6-dist/css/bootstrap.min.css" />
		<link rel="stylesheet" href="ressources/bootstrap-datetimepicker-master/bootstrap-datetimepicker.min.css"/>
		<link rel="stylesheet" href="ressources/jqwidgets-ver4.1.1/jqx.base.css" />
		<link rel="stylesheet" href="ressources/custom.css" />
	</head>
	<body>
		<div class="container-fluid">

			<!-- Colonne gauche -->
			<div class="header col-md-3">
				<div data-w3-include-html="./part_menu.html"></div> 
			</div>
			
			<div class="content col-md-9">

				<div data-w3-include-html="./part_infoMariage.html"></div>
				<script type="text/javascript" src="./part_infoMariage.js"></script>

				<div id="invites"></div>

			</div>
		</div>

		<script type="text/javascript" src="ressources/w3-include-HTML.js"></script> 
		<script type="text/javascript" src="ressources/jquery-ui-1.11.4.custom/external/jquery/jquery.js"></script>
		<script type="text/javascript" src="ressources/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
		<script type="text/javascript" src="ressources/bootstrap-datetimepicker-master/bootstrap-datetimepicker.min.js"></script>
		<script type="text/javascript" src="ressources/bootstrap-datetimepicker-master/locales/bootstrap-datetimepicker.fr.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxcore.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxbuttons.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxscrollbar.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxmenu.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.edit.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.selection.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.columnsresize.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.filter.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxgrid.sort.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxdata.js"></script> 
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxscrollbar.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxdropdownlist.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxlistbox.js"></script>
		<script type="text/javascript" src="ressources/jqwidgets-ver4.1.1/jqxwindow.js"></script>
		<script type="text/javascript" src="ressources/common.js"></script>
		<script type="text/javascript">

		var donneesDejaChargees = false;

		// Fonction JqxGrid
		var modifieInvite = function(e) {
			majAttribute(REST_PREFIX + "/mariage/" + idMariage + "/invite", e, chargeInvites);
		}


		// Chargement des invites
		var chargeInvites = function() {
			if (donneesDejaChargees) {
				$("#invites").jqxGrid('updatebounddata', 'cells');
			} else {
				var dataAdapter = new $.jqx.dataAdapter({
					datatype: "json",
					url: REST_PREFIX + "/mariage/" + idMariage + "/invite",
					datafields: [
						{ name: 'id', type: 'string' },
						{ name: 'groupe', type: 'string' }, { name: 'foyer', type: 'string' },
						{ name: 'nom', type: 'string' }, { name: 'prenom', type: 'string' }
					],
					id: 'id'
				});
				var rendererColonneBouton = function (rowIndex, columnfield, value, defaulthtml, columnproperties) { return '<a href="javascript:supprimeInvite(' + value + ')" id="btn' + value + '"><span class="ui-icon ui-icon-trash"></span></a>' };
				$("#invites").jqxGrid({
					source: dataAdapter,
					columns: [
						{ text: 'Groupe', datafield: 'groupe', editable: false, width: "25%" }, { text: 'Foyer', datafield: 'foyer', editable: false, width: "25%" },
						{ text: 'Nom', datafield: 'nom', editable: false, width: "25%" }, { text: 'Prenom', datafield: 'prenom', editable: false, width: "25%" }
					],
					editable: true,
					sortable: true,
					filterable: true,
					autoheight: true,
					width: 950
				});
				$("#invites").on('cellendedit', modifieInvite);
				donneesDejaChargees = true;
			}
		};

		$(document).ready(function() {
			// Init
			chargeInvites();
		});
		</script>
	</body>
</html>